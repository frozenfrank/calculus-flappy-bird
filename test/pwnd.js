// Authored by James Finlinson 2022
// Copy right OneClick, LLC

/*! For license information please see script-bundle.min.js.LICENSE.txt */
!function(){"use strict";var t={"./src/script/compile-data.ts":function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.padZeros=e.compileData=void 0;const n="https://app.hotschedules.com/hs/spring",o=6048e5;function a(t,e){return p(e.find((e=>e.id===t.clientId)).externalRef,5)}function s(t){const e=i();return Promise.all([c(`${n}/client/employee/?active=true`),c(`${n}/client/jobs/?_=${e}`),c(`${n}/client/roles/?_=${e}`),c(`${n}/client/locations/?_=${e}`),c(`${n}/employee/${t.userId}/schedule?_=${e}`),c(`${n}/my/clients?_=${e}`)])}function r(t){const e=new Date(+t+o),a=u(t),s=u(e),r=l(t),d=l(e),p=i();return Promise.all([c(`${n}/shifts/posted/?start=${a}&end=${s}&_=${p}`),c(`${n}/scheduling/shift/?start=${a}T00%3A00&end=${s}T00%3A00&_=${p}`),c(`${n}/scheduling/day-notes?startDate=${a}&endDate=${a}&_=${p}`)]).then((t=>({start:a,end:s,startDate:r,endDate:d,shifts:t[0],unpostedShifts:t[1],notes:t[2]})))}function c(t){return fetch(t).then((t=>t.json()))}function u(t){return p(t.getFullYear(),4)+"-"+p(t.getMonth()+1,2)+"-"+p(t.getDate(),2)}function i(){return""+(new Date).valueOf()}function l(t){return new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate()))}function d(t){let e="";const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",o=n.length;for(let a=0;a<t;a++)e+=n.charAt(Math.floor(Math.random()*o));return e}function p(t,e,n="0"){return(""+t).padStart(e,n)}e.compileData=function(){const t=new Date,e=new Date(+t+864e5*(0-t.getDay()));return e.setHours(0,0,0,0),function(){const t=i();return c(`${n}/my/session?_=${t}`)}().then((t=>Promise.all([t,s(t),r(new Date(+e+0)),r(new Date(+e+6048e5)),r(new Date(+e+2*o))]))).then((([e,n,o,s,r])=>{const c=function(...t){const e={weeks:[],weekData:{}};for(let t of arguments){const n=d(32);e.weeks.push({startDate:t.startDate,endDate:t.endDate,dataId:n}),e.weekData[n]=t}return e}(o,s,r);return{uploadDate:t,storeNumber:a(e,n[5]),bookmarkletVersion:2,session:e,employees:n[0],jobs:n[1],roles:n[2],locations:n[3],schedules:n[4],clients:n[5],weeks:c.weeks,weekData:c.weekData}}))},e.padZeros=p},"./src/script/upload-data.ts":function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.uploadData=void 0;const n="https://us-central1-hotautoscheduler.cloudfunctions.net/processBusinessUAID";e.uploadData=function(t){return console.log(`Uploading data to ${n}: `,t),function(t,e){return fetch("https://us-central1-hotautoscheduler.cloudfunctions.net/processBusinessUAID",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((t=>t.json()))}(0,t).then((t=>!0)).catch((()=>!1))}}},e={};function n(o){var a=e[o];if(void 0!==a)return a.exports;var s=e[o]={exports:{}};return t[o](s,s.exports,n),s.exports}var o={};!function(){var t=o;Object.defineProperty(t,"__esModule",{value:!0});const e=n("./src/script/compile-data.ts"),a=n("./src/script/upload-data.ts");window.OC_UAID=function(){return(0,e.compileData)().then((t=>(0,a.uploadData)(t))).then((t=>{t?alert("✅ Data uploaded!"):alert("⚠️ Data NOT uploaded.")})).catch((t=>{console.log("Error executing User Authorized and Initiated Data transfer (UAID): "+t),alert("❌ Error uploading data")}))}}()}();
//# sourceMappingURL=script-bundle.min.js.map
