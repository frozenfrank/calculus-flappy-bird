// Authored by James Finlinson 2022
// Copy right OneClick, LLC

/*! For license information please see script-bundle.min.js.LICENSE.txt */
!function(){"use strict";var e={"./src/script/compile-data.ts":function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.padZeros=t.compileData=void 0;const n="https://app.hotschedules.com/hs/spring",a=6048e5;function o(e,t){return p(t.find((t=>t.id===e.clientId)).externalRef,5)}function r(e){const t=u();return Promise.all([i(`${n}/client/employee/?active=true`),i(`${n}/client/jobs/?_=${t}`),i(`${n}/client/roles/?_=${t}`),i(`${n}/client/locations/?_=${t}`),i(`${n}/employee/${e.userId}/schedule?_=${t}`),i(`${n}/my/clients?_=${t}`)])}function s(e){const t=new Date(+e+a),o=c(e),r=c(t),s=l(e),d=l(t),p=u();return Promise.all([i(`${n}/shifts/posted/?start=${o}&end=${r}&_=${p}`),i(`${n}/scheduling/shift/?start=${o}T00%3A00&end=${r}T00%3A00&_=${p}`),i(`${n}/scheduling/day-notes?startDate=${o}&endDate=${o}&_=${p}`)]).then((e=>({start:o,end:r,startDate:s,endDate:d,shifts:e[0],unpostedShifts:e[1],notes:e[2]})))}function i(e){return fetch(e).then((e=>e.json()))}function c(e){return p(e.getFullYear(),4)+"-"+p(e.getMonth()+1,2)+"-"+p(e.getDate(),2)}function u(){return""+(new Date).valueOf()}function l(e){return new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()))}function d(e){for(var t="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",a=n.length,o=0;o<e;o++)t+=n.charAt(Math.floor(Math.random()*a));return t}function p(e,t,n="0"){return(""+e).padStart(t,n)}t.compileData=function(){const e=new Date,t=new Date(+e+864e5*(0-e.getDay()));return t.setHours(0,0,0,0),function(){const e=u();return i(`${n}/my/session?_=${e}`)}().then((e=>Promise.all([e,r(e),s(new Date(+t+0)),s(new Date(+t+6048e5)),s(new Date(+t+2*a))]))).then((([t,n,a,r,s])=>{const i=function(...e){const t={weeks:[],weekData:{}};for(let e of arguments){const n=d(32);t.weeks.push({startDate:e.startDate,endDate:e.endDate,dataId:n}),t.weekData[n]=e}return t}(a,r,s);return{uploadDate:e,storeNumber:o(t,n[5]),bookmarkletVersion:1,session:t,employees:n[0],jobs:n[1],roles:n[2],locations:n[3],schedules:n[4],clients:n[5],weeks:i.weeks,weekData:i.weekData}}))},t.padZeros=p},"./src/script/upload-data.ts":function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.uploadData=void 0,t.uploadData=function(e,t){return console.log(`Uploading data to ${t}: `,e),console.warn("UAID: uploadData not yet implemented"),Promise.resolve(!1)}}},t={};function n(a){var o=t[a];if(void 0!==o)return o.exports;var r=t[a]={exports:{}};return e[a](r,r.exports,n),r.exports}var a={};!function(){var e=a;Object.defineProperty(e,"__esModule",{value:!0});const t=n("./src/script/compile-data.ts"),o=n("./src/script/upload-data.ts");window.OC_UAID=function(){return(0,t.compileData)().then((e=>(0,o.uploadData)(e,"some/upload/location"))).then((e=>{e?alert("✅ Data uploaded!"):alert("⚠️ Data NOT uploaded.")})).catch((e=>{console.log("Error executing User Authorized and Initiated Data transfer (UAID): "+e),alert("❌ Error uploading data")}))}}()}();
//# sourceMappingURL=script-bundle.min.js.map
