// Authored by James Finlinson 2022
// Copy right OneClick, LLC

function compileData(){var pp="https://app.hotschedules.com/hs/spring/";function k(a,c){var b=c.find(function(d){return d.id===a.clientId});return h(b.externalRef,5)}function l(a){var c=new Date(+a+6048E5),b=n(a),d=n(c),e=p(a),f=p(c);a=""+(new Date).valueOf();return Promise.all([g(pp+"shifts/posted/?start="+b+"&end="+d+"&_="+a),g(pp+"scheduling/shift/?start="+b+"T00%3A00&end="+d+"T00%3A00&_="+a),g(pp+"scheduling/day-notes?startDate="+
b+"&endDate="+b+"&_="+a)]).then(function(m){return{start:b,end:d,startDate:e,endDate:f,shifts:m[0],unpostedShifts:m[1],notes:m[2]}})}function q(){a={weeks:[],weekData:{}};for(var c=0,b=arguments;c<b.length;c++){var d=b[c];var e="";for(var f=0;32>f;f++)e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(Math.floor(62*Math.random()));a.weeks.push({startDate:d.startDate,endDate:d.endDate,dataId:e});a.weekData[e]=d}return a}function g(a){return fetch(a).then(function(c){return c.json()})}
function n(a){return h(a.getFullYear(),4)+"-"+h(a.getMonth()+1,2)+"-"+h(a.getDate(),2)}function h(a,c){return(""+a).padStart(c,"0")}function p(a){return new Date(Date.UTC(a.getFullYear(),a.getMonth(),a.getDate()))}return function(){var a=new Date,c=new Date(+a+864E5*(0-a.getDay()));c.setHours(0,0,0,0);return g(pp+"my/session?_="+(new Date).valueOf()).then(function(b){var d=Promise,e=d.all;var f=""+(new Date).valueOf();f=Promise.all([g(pp+"client/employee/?active=true"),
g(pp+"client/jobs/?_="+f),g(pp+"client/roles/?_="+f),g(pp+"client/locations/?_="+f),g(pp+"employee/"+b.userId+"/schedule?_="+f),g(pp+"my/clients?_="+f)]);return e.call(d,[b,f,l(new Date(+c)),l(new Date(+c+6048E5)),l(new Date(+c+12096E5))])}).then(function(b){var d=b[0],e=b[1];b=q(b[2],b[3],b[4]);return{uploadDate:a,storeNumber:k(d,
e[5]),bookmarkletVersion:1,session:d,employees:e[0],jobs:e[1],roles:e[2],locations:e[3],schedules:e[4],clients:e[5],weeks:b.weeks,weekData:b.weekData}})}()}console.time("compileData");compileData().then(function(k){console.timeEnd("compileData");console.log(k);alert("âœ… Success")});
